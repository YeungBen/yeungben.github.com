---
layout: post
title: VPN搭建
category: 技术
tags: VPN
keywords:
description:
---

使用了曲径好久,也快到期了,想想要个一劳永逸的办法,还是得自己搭个梯子,方法简单,记录下操作步骤

1.root 账户登录 VPS

2.安装 PPTPD

编辑 /etc/pptpd.conf 文件，取消注释以下 2 行：

```
localip 192.168.0.1

remoteip 192.168.0.234-238,192.168.0.245
```

3.添加 PPTP 账户

编辑 /etc/ppp/chap-secrets 文件，按如下格式添加：

用户名 pptpd "密码" 允许接入的IP

其中密码要用引号包围。允许任何 IP 接入则用 * 号表示。

4.设置 DNS 服务器

编辑 /etc/ppp/pptpd-options 文件，找到 ms-dns 部分来修改，我使用的是 Google 的：

```
ms-dns 8.8.8.8

ms-dns 8.8.4.4
```

5.开启 IP 转发

编辑 /etc/sysctl.conf 文件，取消注释该行：

```net.ipv4.ip_forward=1```

然后运行这行代码使配置生效：

```sysctl -p```

6.安装 iptables

```
apt-get install iptables

iptables -t nat -I POSTROUTING -j MASQUERADE
```

7.重启 pptpd

```/etc/init.d/pptpd restart```
